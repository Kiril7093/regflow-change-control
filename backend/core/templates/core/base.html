{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{% block title %}RegFlow{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'core/app.css' %}">
  </head>
  <body>
    <header class="nav">
      <div class="left">
        <span class="brand">RegFlow</span>
        <span class="badge">Change Control MVP</span>
        <a class="btn{% if request.path == "/" %} active{% endif %}" href="/">Home</a>
        <a class="btn{% if request.path|slice:":17" == "/change-requests/" %} active{% endif %}" href="/change-requests/">Change Requests</a>
        <a class="btn{% if request.path|slice:":7" == "/admin/" %} active{% endif %}" href="/admin/">Admin</a>
      </div>
      <div class="right">
        {% if user.is_authenticated %}
          <span class="muted">Signed in as <strong>{{ user.username }}</strong></span>
          <a class="btn" href="/accounts/logout/">Logout</a>
        {% else %}
          <a class="btn primary" href="/accounts/login/">Login</a>
        {% endif %}
      </div>
    </header>

    <main class="container">
      {% block content %}{% endblock %}
    </main>
  <script>
// Make table rows clickable (data-href on tr.rowlink)
document.addEventListener("click", function (e) {
  const row = e.target.closest("tr.rowlink");
  if (!row) return;

  // Donâ€™t hijack clicks meant for interactive elements
  if (e.target.closest("a, button, input, select, textarea")) return;

  const href = row.getAttribute("data-href");
  if (!href) return;

  if (e.metaKey || e.ctrlKey) {
    window.open(href, "_blank", "noopener");
  } else {
    window.location.href = href;
  }
});
</script>
</body>
</html>
